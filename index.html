<!doctype html>
<html>
  <head>
   	<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/rainbow.min.css">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <style>
    	body {
    		font-family: Arial;
    		width: 820px;
			  margin: 5px auto;
        font-size: 15px;
    	}

    	hgroup h1 {
        text-align: right;
        border-bottom: 2px solid #CCC;
        padding-bottom: 5px;
        margin-bottom: 2px;
    	}

      p {
        color: #555;
        line-height: 1.5;
      }

    	hgroup h1 .hljs {
    		padding: 2px;
        font-size: 12pt;
        border: none;
        background-color: white;
    	}

    	hgroup h2 {
    		text-align: right;
			  font-style: italic;
			  margin-top: 5px;
        color: #999900;
    	}

    	h1 pre {
    		padding: 3px;
    		margin: 0px;
    		float: left;
    	}

      h3 {
        padding-bottom: 5px;
        border-bottom: 1px solid #ccc;

      }

      .sample ul {
        list-style: none;
        padding: 10px;
      }

      .sample li {
        width: 250px;
        border: 1px solid #ccc;
        background-color: #FFFAAA;
        margin-bottom: 10px;
        padding: 5px;
      }

      .sample ol {
        padding: 25px;
      }

      .sample1 [dropzone] {
        min-height: 20px;
        width: 500px;
        border-width: 5px;
        border-color:  #ADADAD;
        border-style: dashed;
      }

      [dropzone].drag-matches {
        border-style: solid;
        border-color: green;
        background-color: #CCFFCC; 
      }

      .hljs {
        border: 1px solid #ccc;
        border-radius: 5px;
        line-height: 1.5;
      }

    </style>
  </head>
  <body>
  <a href="https://github.com/stevendwood/html5-dropzone"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png"></a>

  <hgroup>
  	<h1>
  		<pre><code class="html">&lt;div dropzone=&quot;copy s:text/x-example&quot;&gt;</code></pre>
  		HTML5 [dropzone]
  	</h1>
  	
  	<h2>Cross browser HTML5 drag and drop</h2>
  </hgroup>
  <div id="main">
  	
  	<h1>Introduction</h1>
  	<p>
  		A small JavaScript library that provides an implementation of the proposed HTML5 dropzone attribute, and eases development of drag and drop the HTML5 way.  Supports Chrome, Firefox, Safari and IE 10+.
  	</p>

    <h2>Basic example</h2>
    <section class="sample sample1">
      <p>
      This sample is based on the example from the HTML5 <a href="http://www.w3.org/TR/2011/WD-html5-20110525/dnd.html#introduction-7">spec</a>.
      You can drag and drop fruits betweem the two lists. You can also use the platform keyboard modifiers to control whether elements are moved or copied between the lists, for example ctrl on windows will change from move to copy.
      </p>
      <ul >
       <li draggable="true" data-value="fruit-apple">Apples</li>
       <li draggable="true" data-value="fruit-orange">Oranges</li>
       <li draggable="true" data-value="fruit-pear">Pears</li>
      </ul>

      <p>Drop your favorite fruits below, use ctrl on windows to control copy or move:</p>
      <ul dropzone="move string:text/x-example">
      </ul>
      <h3>Implement ondragstart</h3>
      <p> 
          To get this to work, 1st we need to setup a drag start handler to place some data into the DataTransfer object of the drag event, and we need a dragend handler which will fire when the user finishes dragging.  This is just for example, typically you might prefer not to declare event handlers in markup :)
      </p>

       <pre><code class="html">&lt;ul ondragstart=&quot;dragStartHandler(event)&quot; ondragend=&quot;dragEndHandler(event)&quot;&gt;
  &lt;li draggable=&quot;true&quot; data-value=&quot;fruit-apple&quot;&gt;Apples&lt;/li&gt;
  &lt;li draggable=&quot;true&quot; data-value=&quot;fruit-orange&quot;&gt;Oranges&lt;/li&gt;
  &lt;li draggable=&quot;true&quot; data-value=&quot;fruit-pear&quot;&gt;Pears&lt;/li&gt;
&lt;/ul&gt;</code></pre>
 <p>
    We provide some data keyed by the example type "text/x-example", we also specify that the user is allowed to move or copy the list items.  We do the latter by specifying the <a href="https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer">effectAllowed</a>.  Note that if you tried to run this sample <i>without</i> the HTML5 dropzone library, it would not work on Internet Explorer at all.  
 </p>
 <pre><code class="javascript">var internalDNDType = 'text/x-example'; 
function dragStartHandler(event) {
  if (event.target instanceof HTMLLIElement) {
    // use the element's data-value="" attribute as the value to be moving:
    event.dataTransfer.setData(internalDNDType, event.target.dataset.value);
    // only allow the data to be copied or moved
    event.dataTransfer.effectAllowed = 'copyMove'; 
  } 
}</code></pre>
 <h3>Define a [dropzone]</h3>
 <p>
   Now that the dragstart is set up, we need to specify a drop target.  Typically you would need to do this by adding a bunch of event handlers to the node that can accept the drop, and cancelling the events if you decide that the element can take the drop given the data currently being dragged.  With the <code>dropzone</code> attribute you can skip all of that.
 </p>

 <pre><code class="html">&lt;ol dropzone=&quot;move string:text/x-example&quot;&gt; &lt;/ol&gt;</code></pre>

 <p>
   This dropzone specifies that the default operation is "move", and that we accept drags where the drag data kind is a string and the type is text/x-example.  The operation can be specified by the user using platform specific keyboard modifiers, if none are specified the default operation will be "move".  Finally define the drop and drag end handler, which reads the type that we set in dragstart and creates a new li element.  The dragend handler uses the custom function <code>getDropEffect()</code> to test what drop effect the user selected.  If the user did not complete the drop, or the used a keyboard modifier that specified linking then the drop is not allowed and the dropEffect is "none".
 </p>

 <h3>Handle drop and dragend</h3>
 <p>
  In the drop handler we examine the drag data item which is retrieved by type, and build a new list item based on it.  On dragend we need to check whether the user specified a move or a copy, and remove the element from the source if appropriate.
 </p>
    <pre>
      <code class="javascript">function dropHandler(event) {
var li = document.createElement('li'),
    target = event.target,
    data = event.dataTransfer.getData(internalDNDType);

  if (data == 'fruit-apple') {
    li.textContent = 'Apples';
  } else if (data == 'fruit-orange') {
    li.textContent = 'Oranges';
  } else if (data == 'fruit-pear') {
    li.textContent = 'Pears';
  } else {
    li.textContent = 'Unknown Fruit';
  }
        
  if (target instanceof HTMLLIElement) {
    target.parentElement.appendChild(li);
  } else {
    target.appendChild(li);
  }
}

function dragEndHandler(event) {
  // use the custom getDropEffect() method rather than the
  // native dropEffect property to get the correct value on IE
  var dropEffect = event.dataTransfer.getDropEffect();

  if (dropEffect === "move") {
    event.target.parentElement.removeChild(event.target);
  }
}</code></pre>

   <h3 id="draggable">Using draggable</h3>
   <p>
   We can use the draggable function in place of the dragstart listener, this allows you to specify the effectAllowed and
   as many data types as you like, we can also hook up the dragend handler instead of defining the event handler in the markup.
   <pre>
    <code class="javascript">[].forEach.call(document.querySelectorAll(".sample1 li"), function(li) {
  draggable(li)
    .effectAllowed("copyMove")
    .setData("text/x-example", function() { return this.element.dataset.value; })
    .on("dragend", dragEndHandler);
});

document.querySelector(".sample1 [dropzone]").addEventListener("drop", dropHandler);</code></pre>

    </section>
     <script src="dist/dropzone.js"></script>
    <script>

        var internalDNDType = 'text/x-example'; // set this to something specific to your site
        function dragStartHandler(event) {
          if (event.target instanceof HTMLLIElement) {
              // use the element's data-value="" attribute as the value to be moving:
              event.dataTransfer.setData(internalDNDType, event.target.dataset.value);
              event.dataTransfer.effectAllowed = 'copyMove'; // only allow moves

          }
        }

      function dragEndHandler(event) {
          var dropEffect = event.dataTransfer.getDropEffect();

          if (dropEffect === "move") {
            event.target.parentElement.removeChild(event.target);
          }
      }

      function dropHandler(event) {
          var li = document.createElement('li'),
              target = event.target,
              data = event.dataTransfer.getData(internalDNDType);
          if (data == 'fruit-apple') {
              li.textContent = 'Apples';
          } else if (data == 'fruit-orange') {
              li.textContent = 'Oranges';
          } else if (data == 'fruit-pear') {
              li.textContent = 'Pears';
          } else {
              li.textContent = 'Unknown Fruit';
          }
          
          if (target instanceof HTMLLIElement) {
            target.parentElement.appendChild(li);
          } else {
            target.appendChild(li);
          }
        }

        [].forEach.call(document.querySelectorAll(".sample1 li"), function(li) {
          draggable(li)
            .effectAllowed("copyMove")
            .setData("text/x-example", function() {
                return this.element.dataset.value;
            })
            .on("dragend", dragEndHandler);
        });

        document.querySelector(".sample1 [dropzone]").addEventListener("drop", dropHandler);

    </script>

  </div>
  
  </body>
</html>